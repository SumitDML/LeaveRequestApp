"'Apply Leave' As screen":
    Fill: =RGBA(241, 244, 249, 1)

    "'Left Navigation_1' As 'Left Navigation'":
        Width: ='Left Navigation_4'.MenuWidth
        X: =0.00

    Canvas1_1 As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Height: =767
        Width: =Parent.Width-'Left Navigation_1'.Width
        X: ='Left Navigation_1'.Width
        Y: =1
        ZIndex: =2

        DataCard1_1 As dataCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =0
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =Parent.Height
            Width: =Parent.Width
            X: =0
            Y: =0
            ZIndex: =1

            Component2_4 As Component2_3:
                Height: =70
                Width: =Parent.Width
                X: =0.00
                ZIndex: =1

            Button3 As button:
                BorderThickness: =0
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(255, 255, 255, 1)
                Height: =642
                HoverColor: =
                HoverFill: =
                PaddingRight: =5.00
                PaddingTop: =5.00
                Size: =15.00
                Text: =""
                Width: =1095
                X: =36
                Y: =90
                ZIndex: =2

            Label14_1 As label:
                Font: =Font.'Lato Black'
                Height: =32
                Size: =15
                Text: ="Details"
                X: =68
                Y: =220
                ZIndex: =9

            Label14_2 As label:
                Font: =Font.'Lato Black'
                Height: =33
                Size: =15
                Text: ="Reason"
                X: =68
                Y: =118
                ZIndex: =10

            Details As text:
                BorderColor: =RGBA(102, 102, 102, 1)
                BorderThickness: =1
                Default: =""
                Height: =106
                HintText: ="Please ellaborate the reason for applying leave."
                HoverFill: =RGBA(219, 219, 219, 1)
                Reset: =true
                Width: =572
                X: =68
                Y: =252
                ZIndex: =12

            Reason As text:
                BorderColor: =RGBA(102, 102, 102, 1)
                BorderThickness: =1
                Clear: =true
                Default: =""
                Height: =52
                HintText: ="Enter the reason"
                HoverBorderColor: =RGBA(128, 128, 128, 1)
                HoverFill: =RGBA(219, 219, 219, 1)
                Reset: =true
                Width: =301
                X: =68
                Y: =151
                ZIndex: =13

            LeaveTypes As dropdown:
                BorderColor: =RGBA(102, 102, 102, 1)
                ChevronBackground: =RGBA(102, 102, 102, 1)
                ChevronHoverBackground: =
                Default: ="2"
                Height: =52
                HoverFill: =RGBA(219, 219, 219, 1)
                Items: =Choices([@'Leave Requests'].'Leave Type')
                OnChange: |-
                    =Set(vardata,LookUp('Leave Balance_1', 'Leave Type'.Value=LeaveTypes.SelectedText.Value));
                    
                    
                    ClearCollect(LeaveSum,Sum(Filter('Leave Requests','Leave Id'.Value=vardata.Id && RequestedBy.Email=User().Email),'Total Days'));
                    
                    ClearCollect(TotalLeave,Sum(Filter('Leave Balance_1',Id=vardata.Id),'Total Leave'))
                OnSelect: =
                PressedFill: =RGBA(128, 128, 128, 1)
                Reset: =true
                SelectionFill: =RGBA(128, 128, 128, 1)
                Width: =222
                X: =419
                Y: =151
                ZIndex: =14

            "'Apply Leave Button' As button":
                DisplayMode: =If(IsBlank(Reason)||IsBlank(Details),DisplayMode.Disabled)
                Fill: =RGBA(51, 51, 51, 1)
                OnSelect: |-
                    =If(from.SelectedDate<Today(),[Set(errordisplay,true),Set(err,"Please enter a valid start date")],
                    from.SelectedDate>to.SelectedDate,[Set(errordisplay,true),Set(err,"Please enter valid end date")],
                    Int(TotalDays.Text)>Int(RemainingBalance.Text),[Set(errordisplay,true),Set(err,"You don't have enough leave balance.")],
                    
                    Set(var,First(Office365Users.SearchUser({searchTerm:approver.SelectedText.Value})));
                    
                    Patch('Leave Requests',Defaults('Leave Requests'),
                    {Title:Reason.Text},
                    {Details:Details.Text},
                    {'Leave Type':LeaveTypes.SelectedText},
                    {From:from.SelectedDate},
                    {To:to.SelectedDate},
                    {'Total Days':Value(TotalDays.Text)},
                    {'Leave Id':{'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
                        Id:vardata.Id,
                        Value:LeaveTypes.SelectedText.Value
                    }},
                    {RequestedBy: {'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
                        Claims:Lower(User().Email),
                        Department:"",
                        DisplayName:User().FullName,
                        Email:User().Email,
                        JobTitle:"",
                        Picture:""
                        }},
                    {HR: {'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
                        Claims:Lower(User().Email),
                        Department:"",
                        DisplayName:User().FullName,
                        Email:User().Email,
                        JobTitle:"",
                        Picture:""
                        }},
                    {'Reporting Manager':{'@odata.type':"#Microsoft.Azure.Connectors.SharePoint.SPListExpandedReference",
                        Claims:Lower(var.Mail),
                        Department:"",
                        DisplayName:var.Department,
                        Email:var.Mail,
                        JobTitle:"",
                        Picture:""
                        }}
                    )
                    );
                    
                    Set(sucessfulSubmission,true);
                    
                    Reset(Reason);
                    Reset(LeaveTypes);
                    Reset(Details);
                    Reset(from);
                    Reset(to);
                    Reset(approver);
                Text: ="Apply Leave"
                X: =921
                Y: =666
                ZIndex: =15

            Button8 As button:
                BorderColor: =RGBA(128, 128, 128, 1)
                Color: =RGBA(0, 0, 0, 1)
                Fill: =RGBA(0, 0, 0, 0)
                OnSelect: |-
                    =Reset(Reason);
                    Reset(LeaveTypes);
                    Reset(Details);
                    Reset(from);
                    Reset(to);
                    Reset(approver);
                Text: ="Cancel"
                X: =740
                Y: =666
                ZIndex: =16

            Button9 As button:
                BorderThickness: =0.05
                DisabledFill: =RGBA(237, 237, 237, 1)
                DisplayMode: =DisplayMode.Disabled
                Fill: =RGBA(219, 219, 219, 1)
                Height: =410
                RadiusBottomLeft: =15
                RadiusBottomRight: =15
                RadiusTopLeft: =15
                RadiusTopRight: =15
                Text: =""
                Width: =384
                X: =725
                Y: =118
                ZIndex: =17

            Label13 As label:
                Color: =RGBA(102, 102, 102, 1)
                Height: =53
                Text: |-
                    ="Your Request Includes:"
                Width: =196
                X: =740
                Y: =118
                ZIndex: =18

            Label13_1 As label:
                Color: =RGBA(116, 116, 116, 1)
                Height: =32
                Text: |-
                    =LeaveTypes.SelectedText.Value&" Balance:"
                Width: =199
                X: =753
                Y: =431
                ZIndex: =19

            Label13_2 As label:
                Color: =RGBA(116, 116, 116, 1)
                Text: =
                Width: =136
                X: =865
                Y: =166
                ZIndex: =20

            Label13_3 As label:
                Color: =RGBA(116, 116, 116, 1)
                Height: =37
                PaddingRight: =0
                Text: |-
                    ="Leave Type: "&LeaveTypes.SelectedText.Value
                Width: =238
                X: =764
                Y: =166
                ZIndex: =21

            TotalDays As label:
                Color: =RGBA(116, 116, 116, 1)
                Height: =39
                Text: |-
                    =If(
                        And(
                            IsBlank(from),
                            IsBlank(to)
                        ),
                        0,
                        DateDiff(
                            from.SelectedDate,
                            to.SelectedDate
                        )
                     + 1)
                Width: =61
                X: =912
                Y: =274
                ZIndex: =22

            Label13_5 As label:
                Color: =RGBA(116, 116, 116, 1)
                Text: |-
                    ="Number of Days:"
                Width: =147
                X: =765
                Y: =274
                ZIndex: =23

            RemainingBalance As label:
                Color: =RGBA(102, 102, 102, 1)
                Height: =32
                Text: =First(TotalLeave).Value - First(LeaveSum).Value
                Width: =62
                X: =952
                Y: =431
                ZIndex: =25

            to As datepicker:
                BorderColor: =RGBA(102, 102, 102, 1)
                BorderThickness: =1
                Height: =42
                IconBackground: =RGBA(102, 102, 102, 102)
                Reset: =true
                Width: =272
                X: =369
                Y: =410
                ZIndex: =26

            Label14_3 As label:
                Font: =Font.'Lato Black'
                Height: =33
                Size: =15
                Text: ="Leave Type"
                X: =418
                Y: =118
                ZIndex: =28

            Label14_4 As label:
                Font: =Font.'Lato Black'
                Height: =33
                Size: =15
                Text: ="Start Date"
                X: =68
                Y: =377
                ZIndex: =29

            Label14_5 As label:
                Font: =Font.'Lato Black'
                Height: =33
                Size: =15
                Text: ="End Date"
                X: =369
                Y: =377
                ZIndex: =30

            Label14_6 As label:
                Font: =Font.'Lato Black'
                Height: =33
                Size: =15
                Text: ="Reporting Manager"
                Width: =200
                X: =68
                Y: =489
                ZIndex: =32

            approver As dropdown:
                BorderColor: =RGBA(102, 102, 102, 1)
                BorderThickness: =1
                ChevronBackground: =RGBA(102, 102, 102, 1)
                ChevronHoverBackground: =
                Height: =42
                HoverFill: =RGBA(128, 128, 128, 1)
                Items: =managers.Name
                PressedFill: =RGBA(219, 219, 219, 1)
                Reset: =true
                SelectionFill: =RGBA(219, 219, 219, 1)
                Width: =286
                X: =68
                Y: =522
                ZIndex: =33

            from As datepicker:
                BorderColor: =RGBA(102, 102, 102, 1)
                BorderThickness: =1
                Height: =42
                IconBackground: =RGBA(102, 102, 102,1)
                Reset: =true
                Width: =272
                X: =68
                Y: =410
                ZIndex: =34

            Rectangle2 As rectangle:
                BorderColor: =RGBA(102, 102, 102, 1)
                Fill: =RGBA(77, 77, 77, 1)
                Height: =1
                Width: =328
                X: =753
                Y: =418
                ZIndex: =36

            Label4 As label:
                Color: =RGBA(116, 116, 116, 1)
                Text: |-
                    ="Reason:"
                Width: =76
                X: =765
                Y: =313
                ZIndex: =37

            ReasonsText As label:
                Color: =RGBA(116, 116, 116, 1)
                Height: =77
                Text: =Reason.Text
                VerticalAlign: =VerticalAlign.Top
                Width: =242
                X: =841
                Y: =319
                ZIndex: =38

            Label13_4 As label:
                Color: =RGBA(116, 116, 116, 1)
                Height: =32
                Text: |-
                    ="New "&LeaveTypes.SelectedText.Value&" Balance:"
                Width: =237
                X: =753
                Y: =463
                ZIndex: =39

            Label7 As label:
                Color: =RGBA(102, 102, 102, 1)
                Height: =32
                Text: =If(Int(TotalDays.Text)<Int(RemainingBalance.Text),RemainingBalance-TotalDays,0)
                Width: =106
                X: =990
                Y: =463
                ZIndex: =40

            Label8 As label:
                Color: =RGBA(116, 116, 116, 1)
                Height: =30
                Text: |
                    ="From: "&from.SelectedDate
                Width: =237
                X: =765
                Y: =204
                ZIndex: =41

            Label8_1 As label:
                Color: =RGBA(116, 116, 116, 1)
                Height: =30
                Text: |
                    ="To: "&to.SelectedDate
                Width: =237
                X: =765
                Y: =240
                ZIndex: =42

    errordisplaypop As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =7

        Timer2 As timer:
            Duration: =1500
            Height: =38
            OnTimerEnd: =Set(errordisplay,false)
            Start: =errordisplay
            Visible: =errordisplay
            Width: =57
            X: =1266
            Y: =86
            ZIndex: =3

        Rectangle4 As rectangle:
            BorderColor: =RGBA(255, 255, 255, 0.5)
            BorderThickness: =0.5
            Fill: =RGBA(255, 255, 255, 1)
            Height: =104
            Visible: =errordisplay
            Width: =457
            X: =908
            Y: =20
            ZIndex: =4

        Label14 As label:
            Align: =Align.Center
            Height: =104
            Text: =err
            Visible: =errordisplay
            Width: =351
            X: =990
            Y: =20
            ZIndex: =5

        Icon2 As icon.Error:
            Height: =46
            Icon: =Icon.Error
            Visible: =errordisplay
            Width: =44
            X: =937
            Y: =49
            ZIndex: =6

    "'Successful Submission' As group":
        Height: =5
        Width: =5
        X: =80
        Y: =80
        ZIndex: =12

        Rectangle4_1 As rectangle:
            BorderColor: =RGBA(255, 255, 255, 0.5)
            BorderThickness: =0.5
            Fill: =RGBA(255, 255, 255, 0.2)
            Height: =767
            Visible: =sucessfulSubmission
            Width: =1366
            Y: =1
            ZIndex: =7

        Timer2_1 As timer:
            Duration: =1500
            Height: =25
            OnTimerEnd: =Set(succesfulSubmission,false)
            Start: =succesfulSubmission
            Visible: =sucessfulSubmission
            Width: =24
            X: =1266
            Y: =571
            ZIndex: =8

        Button4 As button:
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(0, 0, 0, 1)
            DisabledBorderColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(26, 26, 26, 1)
            Height: =251
            HoverFill: =
            Text: =""
            Visible: =sucessfulSubmission
            Width: =406
            X: =430
            Y: =217
            ZIndex: =9

        Icon3 As icon.Check:
            Icon: =Icon.Check
            Visible: =sucessfulSubmission
            X: =446
            Y: =297
            ZIndex: =10

        Label14_7 As label:
            Align: =Align.Center
            Color: =RGBA(77, 77, 77, 1)
            Height: =79
            Text: ="Leave Successfully Applied."
            Visible: =sucessfulSubmission
            Width: =291
            X: =526
            Y: =297
            ZIndex: =11

